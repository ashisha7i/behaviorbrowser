<!DOCTYPE html><html lang="en"><head><title id='Description'>Behavior Explorer</title><link rel="stylesheet" type="text/css" media="screen" href="css/smoothness/jquery-ui-1.10.3.custom.min.css"/><script type="text/javascript" src="js/jquery-1.9.0.min.js"></script><script type="text/javascript" src="js/jquery.jqGrid.min.js"></script><script type="text/javascript" src="js/jquery-ui.js"></script><script type="text/javascript" src="js/jquery.cookie.js"></script><style>body{font-family: Verdana;font-size: 12px;}table{font-family: Verdana;font-size: 12px;border:1px solid black;border-collapse: collapse;width: 100%;}th, tfoot td{background-color: gray;color: white;font-weight: bold;text-align: left;padding-left: 5px;padding-right: 5px;padding-top: 2px;padding-bottom: 2px;border:1px solid black;}td{color: black;font-weight: normal;padding-left: 5px;padding-right: 5px;padding-top: 2px;padding-bottom: 2px;border:1px solid black;}tr:nth-child(odd){background-color:#eee;}tr:nth-child(even){background-color:#fff;}.error{color: red;font-weight: bold;}.modal{border:1px solid black;background-color: white;width: auto;min-height: 200px;padding: 10px;}.config, .loader, .header{display:none;}#pluginContainer{width: 100%;}.subtext{color: gray;font-size: 10px;}</style><script type="text/javascript">/* Define Columns and Their Associated attributes */ var colModel=new Array();colModel["behavior_id"]="Behavior<br>ID";colModel["behavior_number"]="Behavior <br>Number";colModel["source_behavior_id"]="Source <br>Behavior Id";colModel["name"]="Name";colModel["description"]="Description";colModel["status"]="Status";colModel["standalone_flag"]="Standalone";colModel["foundational_flag"]="Foundational";colModel["start_date"]="Start Date";colModel["end_date"]="End Date";colModel["owner_mapping_id"]="Owner <br>Mapping Id";colModel["ques_mapping_id"]="Question <br>Mapping Id";colModel["multitrack_flag"]="Multitrack";var host="";var index="";var table="";var queryUrl='http://localhost:9200/_search?index=gdrindex&type=behavior&pretty=true&size=';$(document).ready(function (){/* Initializing the dialogs */$("#dialog" ).dialog({autoOpen: false,modal: true,show:{effect: "blind",duration: 100},hide:{effect: "blind",duration: 100},width: 'auto'});$("#config" ).dialog({autoOpen: false,modal: true,show:{effect: "blind",duration: 100},hide:{effect: "blind",duration: 100},width: 'auto',close: function( event, ui ){location.reload();}});if($.cookie("bbcfgHost") && $.cookie("bbcfgIndex") && $.cookie("bbcfgTable")){host=$.cookie("bbcfgHost");index=$.cookie("bbcfgIndex");table=$.cookie("bbcfgTable");}else{$("#config").dialog("open");$("#txtHost").val(window.location.protocol + "//" + window.location.host);$("#txtIndex").val("gdrindex");$("#txtTable").val("behavior");$("#btnSet").focus();return false;}/* First ajax call to get the dataset size */ $.ajax({url: host + "/_count?index=" + index + "&type=" + table,type: 'POST',dataType: 'json',async: false,beforeSend: function(){$("#loader").show();},success: function(dt, Status, jqXHR){/* console.log("Got Data :: " + dt.count);*/queryUrl=host + "/_search?index=" + index + "&type=" + table + "&size="+dt.count;$("#jsonLink").prop("href",queryUrl);$(".header").show();}, error: function(dt, Status, jqXHR){$("#loader").hide();$("#error").html("Error :: <br>" + dt.responseText).show();$("#error").append("<br><br><span style='color:black;font-weight:normal;'><input type='button' value='Clear Configuration and Reload' onClick='resetAndReload();'></span>");}});/* Second Ajax call to get the actual data */$.ajax({url: queryUrl,type: 'POST',dataType: 'json',success: function(data, Status, jqXHR){var recArray=data.hits.hits;var recCount=recArray.length;if(recCount > 0){$("#error").html("");/* Setup the Headers */$("#theHead").append(getHeaderRow());/* Get the records */for(i=0;i<recCount;i++){var hitObj=recArray[i];$("#theBody").append(getTableRow(i, hitObj));}/* Set the footer */$("#theFoot").append("<tr><td colspan='15'>Total records returned : " + recArray.length + "</td></tr>");$("#loader").hide();}else{$("#error").html("Please check if the index is created and then try again.")}}});});function createTd(value){if(value){return "<td>" + value + "</td>";}else{return "<td>--</td>";}}function getDate(dateVal){var dt=new Date(dateVal.substring(0,10));return dt.getMonth() + "/" + dt.getDate() + "/" + dt.getYear();}function getHeaderRow(){var strTableHeader="<tr>";for(var key in colModel){strTableHeader +="<th>" + colModel[key] +"</th>"}strTableHeader +="<th>Track Count</th>";strTableHeader +="</tr>";return strTableHeader;}function getTableRow(index, hitObj){var row="<tr>";for(var key in colModel){if(key.indexOf("date") !=-1){row +="<td>"+hitObj._source.attributes[key].substring(0,10)+"</td>";}else if(key.indexOf("ques_mapping_id") !=-1){var quesMappingId=hitObj._source.attributes[key];row +="<td id='q" +index+ "'>" + quesMappingId +"<img src='img/popup.gif' title='Click to show question details popup.' onClick='openModal("+ quesMappingId +",q"+index+");'></img></td>";}else if(key.indexOf("_flag") !=-1){var flagVal=hitObj._source.attributes[key];row +="<td>" + getFlag(flagVal) +"</td>";}else{if(hitObj._source.attributes[key]){row +="<td>"+hitObj._source.attributes[key]+"</td>";}else{row +="<td>&nbsp;</td>";}}}row +="<td>" + hitObj._source.tracks.length + "</td>";row +="</tr>";return row;}function openModal(quesMappingId, theTd){var tdId=theTd.id;var theUrl=host + "/_search?index=" + index + "&type=" + table + "&pretty=true&q=question.attributes.ques_mapping_id:" + quesMappingId;console.log(theUrl);$.ajax({url: theUrl,type: 'POST',dataType: 'json',success: function(data, Status, jqXHR){var recArray=data.hits.hits;var recCount=recArray.length;if(recCount > 0){addQuesAnsDetails(data);$('#dialog').dialog("open");$("#"+tdId).closest("tr").css("background-color","#ffffaa");$( "#dialog" ).dialog({close: function( event, ui ){$("#"+tdId).closest("tr").css("background-color","");}});}else{$("#error").html("Please check if the index is created and then try again.")}}});/*$('#dialog').html("");$('#dialog').html("Opening for " + quesMappingId);*/}function addQuesAnsDetails(data){var quesAttr=data.hits.hits[0]._source.question.attributes;quesData="<tr><td>" + quesAttr.question_id + "</td><td>" + quesAttr.question_text + "</td><td>" + quesAttr.answer_type + "</td><tr>";$("#quesTBody").html("");$("#quesTBody").append(quesData);$("#ansTBody").html("");var answers=data.hits.hits[0]._source.question.answers;var ansCount=answers.length;for(i=0;i<ansCount;i++){var row="<tr><td>" + answers[i].answer_id + "</td><td>" + answers[i].answer_value + "</td><td>" + getFlag(answers[i].correct_answer) + "</td></tr>";$("#ansTBody").append(row);}}function getFlag(value){if(value=='Y'){return "<img src='img/flag_" + value + ".gif'></img>";}else{return "<img src='img/Transparent.png'></img>";}}function setCookies(){var host=$("#txtHost").val();var index=$("#txtIndex").val();var table=$("#txtTable").val();$.cookie("bbcfgHost", host,{expires: 365, path: '/'});$.cookie("bbcfgIndex", index,{expires: 365, path: '/'});$.cookie("bbcfgTable", table,{expires: 365, path: '/'});location.reload();}function resetAndReload(){$.removeCookie('bbcfgHost',{path: '/'});$.removeCookie('bbcfgIndex',{path: '/'});$.removeCookie('bbcfgTable',{path: '/'});location.reload();}</script></head><body class='default'><h3 class="header">Basic Browser for 'behaviors' table in 'gdrindex': <i><a id="jsonLink" href="#" style="font-weight: normal;">Click here for JSON</a></i></h3><div id="config" class="config" title="Application Not Configured"><p>Please specify the host, index name and table name for 'behavior' index: <br><span class="subtext">(Values are auto filled, if everything looks okay just press 'Set' to set the configuration and reload the application.)</span></p>Host : <input type="text" id="txtHost" size="60">&nbsp;Index : <input type="text" id="txtIndex">&nbsp;Table : <input type="text" id="txtTable">&nbsp;<input type="button" value="Set" onClick="setCookies();" id="btnSet"></div><div id='pluginContainer' style="font-size: 13px;font-family: Verdana;float: left;"><table id="jqgrid"><thead id="theHead"></thead><tfoot id="theFoot"></tfoot><tbody id="theBody"></tbody></table><div id="error" class="error"></div><div id="loader" class="loader">Loading <img src='img/spinner.gif'></img></div></div><div id="dialog" class="modal" style="display:none;" title="Screening Question Details"><p>Question Details:</p><table id="quesDetails"><thead><th>Question ID</th><th>Question Text</th><th>Answer Type</th></thead><tbody id="quesTBody"></tbody></table><p>Answer Details</p><table id="ansDetails"><thead><th>Answer Id</th><th>Answer Value</th><th>Correct</th></thead><tbody id="ansTBody"></tbody></table></div></body></html>